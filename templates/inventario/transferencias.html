{% extends 'partials/system/layout1.html' %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Transferencias de Inventario</h1>
<a href="{{ url_for('transferencias.nueva_transferencia') }}" class="btn btn-primary mb-4">Nueva Transferencia</a>
<table class="table w-full">
    <thead>
        <tr>
            <th>Producto</th>
            <th>Almacén Origen</th>
            <th>Almacén Destino</th>
            <th>Cantidad</th>
            <th>Fecha</th>
            <th>Estatus</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for t in transferencias %}
        <tr>
            <td>{{ t.producto.nombre }}</td>
            <td>{{ t.almacen_origen.nombre }}</td>
            <td>{{ t.almacen_destino.nombre }}</td>
            <td>{{ t.cantidad }}</td>
            <td>{{ t.fecha.strftime('%Y-%m-%d') }}</td>
            <td>{{ t.estatus }}</td>
            <td>
                <form method="post" action="{{ url_for('transferencias.actualizar_estado', id=t.id) }}"
                    style="display:inline-block;">
                    <select name="estatus">
                        <option value="En revisión" {% if t.estatus=='En revisión' %}selected{% endif %}>En revisión
                        </option>
                        <option value="Aprobado" {% if t.estatus=='Aprobado' %}selected{% endif %}>Aprobado</option>
                        <option value="Realizado" {% if t.estatus=='Realizado' %}selected{% endif %}>Realizado</option>
                    </select>
                    <button type="submit" class="btn btn-sm">Actualizar</button>
                </form>
                {% if t.estatus == 'Aprobado' %}
                <form method="post" action="{{ url_for('transferencias.realizar_transferencia', id=t.id) }}"
                    style="display:inline-block;">
                    <button type="submit" class="btn btn-success btn-sm">Realizar</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}